import SwiftUI

@main
struct ShelfScanDemoApp: App {
    init() {
        // 1) Find the Caches directory in our sandbox.
        if let cachesURL = FileManager.default.urls(
            for: .cachesDirectory,
            in: .userDomainMask
        ).first {
            // 2) Point at CoreML’s cache folder:
            let coreMLCacheURL = cachesURL.appendingPathComponent("com.apple.coreml")

            // 3) If that folder exists, remove it now:
            if FileManager.default.fileExists(atPath: coreMLCacheURL.path) {
                do {
                    try FileManager.default.removeItem(at: coreMLCacheURL)
                    print("✅ Cleared CoreML cache at \(coreMLCacheURL.path)")
                } catch {
                    print("⚠️ Failed to delete CoreML cache: \(error)")
                }
            }
        }
        // (If you have any other model‐temp folders, delete them here as well.)
    }

    // Your existing code:
    var inferenceViewModel: InferenceViewModel = InferenceViewModel()
    var body: some Scene {
        WindowGroup {
            HomePageView(inferenceViewModel: inferenceViewModel)
        }
    }
}
